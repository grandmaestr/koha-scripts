#!/bin/bash

# Description: This script sets up the required environment for the 'set_password.pl' script in the Koha library system.
# It creates the /bin/admin directory, creates a symbolic link to set_password.pl, and inserts a line at the beginning of the file.

# Usage: sudo bash setup_koha_admin.sh

# Check if the script is being run as root
if [ "$EUID" -ne 0 ]; then
  echo "Please run this script with sudo."
  exit 1
fi

# Create the /bin/admin directory
mkdir -p /bin/admin

# Create a symbolic link to set_password.pl
ln -sf /usr/share/koha/bin/admin/set_password.pl /bin/admin/set_password.pl

# Insert "use '/usr/share/koha/lib'" at the beginning of set_password.pl
sed -i '1i use '\''/usr/share/koha/lib'\'';' /bin/admin/set_password.pl

# Inform the user that the setup is complete
echo "Koha admin setup complete."
